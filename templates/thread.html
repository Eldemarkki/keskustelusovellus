<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ thread.title }}</title>
    <style>
        textarea {
            resize: vertical;
        }

        h1 {
            margin: 0
        }

        .new-participant-form {
            display: flex;
            flex-direction: column;
            max-width: 30rem;
        }

        .message-form {
            display: flex;
            flex-direction: column;
            max-width: 30rem;
        }

        .title {
            display: flex;
            align-items: center;
            margin-block: 1rem;
        }

        .private-participant-row {
            display: grid;
            grid-template-columns: 1fr auto;
        }

        .private-participant-list {
            max-width: 30rem;
            padding: 0;
        }
    </style>
</head>

<body>
    <a href="/">Etusivu</a>
    <a href="/topics/{{ topic.slug }}">Selaa {{ topic.name }}</a>
    <div class="title">
        {% if thread.private %}
        <img src="/static/lock.svg" width="32" height="32" />
        {% endif %}
        <h1>{{ thread.title }}</h1>
    </div>
    {% if thread.private and show_participant_list %}
    <details 
        {% if is_participants_open %}open=''{% endif %}
    >
        <summary>Yksityisen ketjun osallistujat</summary>
        <h2>Lisää uusi osallistuja</h2>
        {% if error and error|length > 0 %}
        <p>{{ error }}</p>
        {% endif %}
        <form action="/threads/{{ thread.id }}/add-participant" method="post" class="new-participant-form">
            <label for="participant-username">Osallistujan käyttäjänimi</label>
            <input type="text" name="participant-username" autocomplete="off" />
            <input type="submit" value="Lisää osallistuja" />
        </form>
        <ul class="private-participant-list">
            {% for participant in private_participants %}
            <li class="private-participant-row">
                <span>{{ participant.username }}</span>
                <form action="/threads/{{ thread.id }}/remove-participant" method="post">
                    <input type="hidden" name="participant-id" value="{{ participant.user_id }}" />
                    <input type="submit" value="Poista" />
                </form>
            </li>
            {% endfor %}
        </ul>
        <hr />
    </details>
    {% endif %}
    {% if follows_thread %}
    <form action="/threads/{{ thread.id }}/unfollow" method="post">
        <input type="submit" value="Lopeta ketjun seuraaminen" />
    </form>
    {% else %}
    <form action="/threads/{{ thread.id }}/follow" method="post">
        <input type="submit" value="Seuraa ketjua" />
    </form>
    {% endif %}
    <h2>Uusi viesti</h2>
    <form action="/threads/{{ thread.id }}" method="post" class="message-form">
        <label for="message">Viesti</label>
        <textarea name="message"></textarea>
        <input type="submit" value="Lähetä viesti" />
    </form>
    <ul>
        {% for message in messages %}
        <li>
            <b>{{ message.username }}:</b> {{ message.message }}
        </li>
        {% endfor %}
    </ul>
</body>

</html>